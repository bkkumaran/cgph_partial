<apex:page controller="EdisonAHPcontroller" showHeader="false" standardStylesheets="false">

<!-- COLORS -->
<apex:variable id="goodGreen" var="goodGreen" value="#53e09d"/>
<apex:variable id="darkGreen" var="darkGreen" value="rgb(0,113,107)"/>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans');
    table {border-collapse:collapse;}
    td {padding: 3px 3px 3px 3px; font-family:'Open Sans'; font-size:9pt;}
    input {font-family:'Open Sans'; font-size:10pt;}
    .label { font-size:10pt;font-family:'Open Sans';}
    .topHead {font-weight: bold; font-size:18pt; font-family:'Open Sans'; color:rgb(0, 101, 168);}
    .head {font-weight: bold; font-size:10pt;}
    .heading {font-weight:bold; text-decoration:underline; padding-top:12px; font-size:11pt}
    .warn{color:red;}
    .right {text-align:right;}
    .inelig {background-color: RGB(255,183,93) font-weight:bold;}
    .elig {background-color: #6dedb0; font-weight:bold;}
    .results {border: 1px solid black;}
    .hide {display:none;}
    .buttonSubmit{
        white-space: nowrap;
        text-decoration:none;
        font-size: 9pt;
        color: black;
        font-family: 'Open Sans';
        font-weight: bold;
        background-image: linear-gradient(white,#d4d4d4);
        border-radius: 3px; 
        border-top: 1px solid #CCCCCC; 
        border-right: 1.5px solid gray; 
        border-bottom: 1.5px solid gray; 
        border-left: 1px solid #CCCCCC; 
        padding: 5px 10px 5px 10px;
        }
     .buttonSubmit:hover{
        color:white;
        background-image: linear-gradient(gray,gray);
        text-decoration:none;
            }
    .buttonApply{
        white-space: nowrap;
        text-decoration:none;
        font-size: 9pt;
        color: black;
        font-family: 'Open Sans';
        font-weight: bold;
        background-image: linear-gradient(white,{!goodGreen});
        border-radius: 3px; 
        border-top: 1px solid #CCCCCC; 
        border-right: 1.5px solid gray; 
        border-bottom: 1.5px solid gray; 
        border-left: 1px solid #CCCCCC; 
        padding: 5px 10px 5px 10px;
        }
     .buttonApply:hover{
        color:white;
        background-image: linear-gradient({!darkGreen},{!darkGreen});
        text-decoration:none;
            }    
                
</style>

<apex:variable var="width1" value="200"/>
<apex:variable var="width2" value="75"/>


<script type="text/javascript">
    function goToPage() {
        var ListPrice= document.getElementById('ListPrice').value;
        var Bedrooms= document.getElementById('Bedrooms').value;
        var HOA= document.getElementById('HOA').value;
        var code = document.getElementById('code').value;
        var down = document.getElementById('down').value;
        window.location= "https://cgph--jbtests--c.sandbox.vf.force.com/apex/EdisonAHP?core.apexpages.devmode.url=0&code=" + code + "&lp="+ ListPrice + "&br=" + Bedrooms + "&dp=" + down + "&hoa=" + HOA +'&display=show';
        return false;
    }
</script>        




<!-- ---------------------------------------------------------------- -->
<!-- ----------------------FORM ENTRY-------------------------------- -->
<!-- ---------------------------------------------------------------- -->

<table border="0" style="border-color:blue;">
<tr>



<td class="topHead" colspan="2">
Edison Affordable Homeownership Program
</td>
</tr>
<tr>

<td style="vertical-align:top">
<table border="0">
    <tr>
        <td colspan="2">
            <div class="heading" >Enter property data to check eligibility for program:</div>
        </td>
    </tr>
    <tr>
        <td class="label">
            List Price
        </td>
        <td>
            <input type="number" id="ListPrice" oninput="this.value = Math.round(this.value);" value="{!ListPrice}"/>
        </td>
    </tr>
    <tr>
        <td class="label">
            Bedrooms
        </td>
        <td>
            <input type="number" id="Bedrooms" oninput="this.value = Math.round(this.value);" value="{!Bedrooms}"/>
        </td>
    </tr>
    <tr>
        <td class="label">
            HOA/Condo Fees
        </td>
        <td>
            <input type="number" id="HOA" oninput="this.value = Math.round(this.value);" value="{!HOA}"/>
        </td>
    </tr>
    
    <!-- ---------------------------- APPLICANT CODE ------------------  -->
    
    <tr style="{!IF(preAppId = NULL, '', 'display:none;')}">
        <td colspan="2">
            <div class="heading" style="{!IF(preAppCheck= 1,'display:none;','')}">Enter your code to check income eligibility data:</div>
            <div class="heading warn" style="{!IF(preAppCheck= 2,'','display:none;')}">CODE NOT RECOGNIZED, TRY AGAIN</div>
        </td>
    </tr>
    <tr style="{!IF(preAppId = NULL, '', 'display:none;')}">
        <td class="label">
            Applicant Code
        </td>
        <td>
            <input type="text" id="code" value="{!preAppId}"/>
        </td>
    </tr>
    
    
    <tr>
        <td colspan="2">
            <div class="heading" >Enter maximum down payment you can povide.</div>
        </td>
    </tr>
    <tr>
        <td class="label">
            Down Payment Available
        </td>
        <td>
            <input type="text" id="down" value="{!downPayment}"/>
        </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:right" height="50px">
            <input class="buttonSubmit" type="submit" value="SUBMIT" onclick="goToPage();" />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </td>
    </tr>

<!-- ---------------------------------------------------------------- -->
<!-- ----------------------DETERMINATION----------------------------- -->
<!-- ---------------------------------------------------------------- -->
    <tr>
        <td colspan="2"  class="{!IF(finalResult = 0,'hide','results')}" width="400px">
            <div> <b>RESULTS: </b></div>
            <div class="{!IF(finalResult=1,'','hide')}">
                Based on the information you have provided, you are potentially eligible to purchase this property through the Edison Affordable Homeownership Program.
                Click the <span style="color:{!darkGreen};font-weight:bold;">APPLY FOR PROPERTY</span> button below to fill out a form to start the process.
                Once completed, a staff member from CGP&amp;H will reach out to you shortly with details for the next steps. <br/>
            </div>
<apex:variable: id="preAppIncFormat" var="preAppIncFormat" value="${!IF(LEN(TEXT(preAppInc))>3,LEFT(TEXT(preAppInc),LEN(TEXT(preAppInc))-3)&','&RIGHT(TEXT(preAppInc),3),'NO')}"/>
<apex:variable: id="modIncLimFormat" var="modIncLimFormat" value="${!IF(LEN(TEXT(modIncLim))>3,LEFT(TEXT(modIncLim),LEN(TEXT(modIncLim))-3)&','&RIGHT(TEXT(modIncLim),3),'NO')}"/>
            <div class="{!IF(finalResult=2,'','hide')}">
                The income you submitted for your household ({!preAppIncFormat}) is above the maximum income allowed by the Affordable Housing Program ({!modIncLimFormat}).
                If your income is incorrect,
                <a href="{!preAppURL}" target="_blank">please click here to update your profile</a>
                with your current household income.<br/><br/>
                To review maximum income limits, please
                <a href="https://www.affordablehomesnewjersey.com/knowledge-article/what-are-the-maximum-income-limits/" target="_blank">click here</a>.
            </div>
            <div class="{!IF(finalResult=3,'','hide')}">
                The price of the home is too low to be Eligible for the Program. Please continue to look for other homes in Edison and when you find one, enter the home’s information into this calculator to assess its potential eligibility for this program. 
            </div>
            <div class="{!IF(finalResult=4,'','hide')}">
                The price of the home is too high to be eligible for the Program. Please continue to look for other homes in Edison and when you find one, enter the home’s information into this calculator to assess its potential eligibility for this program. 
            </div>
            <div class="{!IF(finalResult=5,'','hide')}">
                Affordable housing regulations require a maximum of only 2 people per bedroom. Your household size of {!preAppHHS} is too large for this property.
                If your household size is incorrect,
                <a href="{!preAppURL}" target="_blank">please click here to update your profile</a>
                with your current household size.<br/><br/>
                Please continue to look for other homes in Edison and when you find one, enter the home’s information into this calculator to assess its potential eligibility for this program. 
            </div>
<apex:variable: id="dpaMinFormat" var="dpaMinFormat" value="${!IF(LEN(TEXT(dpMin))>3,LEFT(TEXT(dpMin),LEN(TEXT(dpMin))-3)&','&RIGHT(TEXT(dpMin),3),'NO')}"/>
            <div class="{!IF(finalResult=6,'','hide')}">
                The monthly expenses for this property exceed 33% of your monthly income. Under the terms of the Edison Affordabile Homeownership Program, your monthly expenses must be at or below 33% in order to qualify to purchase the unit.
                For that reason, this unit is priced too high for your household to purchase through this program. If your income is incorrect,
                <a href="{!preAppURL}" target="_blank">please click here to update your profile</a>
                with your current household income.<br/><br/>
                To review how minimum income requirements are calculated, please
                <a href="https://www.affordablehomesnewjersey.com/knowledge-article/is-there-a-minimum-income-requirement-to-purchase-or-rent-an-affordable-home/" target="_blank">click here</a>.
                <br/><br/>
                Please continue to look for other homes in Edison and when you find one, enter the home’s information into this calculator to assess its potential eligibility for this program.
            </div>
            <div id="downpaymentMsg" class="{!IF(AND(dpCheck=2,finalResult=1),'','hide')}">
                <br/>
                <b>PLEASE NOTE:</b><br/>
                You have provided a <u>down payment</u> amount that is less than 5% of the purchase price after the subsidy is applied.
                This does not disqualify you from the program but you will not be eligible to receive the Edison Township Down Payment Assistance.
                To receive the Down Payment Assistance you are required to put at least 5% of your own funds down towards the subsidized purchase price.
                This may affect your ability to be eligible for this property during the full application process.
                For this property, the minimum down payment amount is {!dpaMinFormat}.
            </div>
        </td>
    </tr>
    <tr class="{!if(finalResult=1,'','hide')}">
        <td style="text-align:center;" colspan="2">
            <br/>
            <a class="buttonApply" href="https://www.tfaforms.com/4987248?tfa_31={!preAppId}&tfa_2={!preAppEmail}&tfa_8={!downPayment}&tfa_10={!Bedrooms}&tfa_25={!ListPrice}&tfa_16={!HOA}" target="_blank"> APPLY FOR PROPERTY</a>
        </td>
    </tr>    
</table>

<!-- ---------------------------------------------------------------- -->
<!-- --------------------CALCULATIONS-1------------------------------ -->
<!-- ---------------------------------------------------------------- -->
</td>
<td style="vertical-align:top">
<div style="{!IF(display='show','','display:none;')}">
<br/>
<br/>

<table border="1" style="border-collapse:collapse;" class="hide">

    <tr style="vertical-align:top">
        <td width="{!width1}" style="vertical-align:top">
            Theoretical Mod Income
        </td>
        <td class="right" width="{!width2}">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!tModIncome}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Theoretical Max Monthly Cost
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!tMaxMonthlyCost}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Theoretical Monthly Costs
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!tMonthlyCosts}"/>
            </apex:outputText>
        </td>
    </tr>
<!--
    <tr>
        <td>
            Theoretically Already Affordable?
        </td>
        <td class="right">
            Y/N
        </td>
    </tr>
-->
    <tr>
        <td>
            Theoretical Costs w Subsidy
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!CostWithSubsidy}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td colspan="2" class="{!CASE(propEligInt,1,'elig',2,'inelig','')}">
            Propert Eligibility Message
        </td>
    </tr>
</table>

<!-- ---------------------------------------------------------------- -->
<!-- --------------------CALCULATIONS 2------------------------------ -->
<!-- ---------------------------------------------------------------- -->

<table border="1" style="{!IF(propEligInt=1,'','display:none;')}" class="hide">
    <tr>
        <td width="{!width1}">
            Applicant Initials
        </td>
        <td class="right" width="{!width2}">
            {!preAppName}
        </td>
    </tr>
    <tr>
        <td>
            Applicant Income
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!preAppInc}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Household Size
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, ###}">
                <apex:param value="{!preAppHHS}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Moderate Income Limit
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!modIncLim}"/>
            </apex:outputText>
        </td>
    </tr>
</table>

<!-- ---------------------------------------------------------------- -->
<!-- --------------------CALCULATIONS 3------------------------------ -->
<!-- ---------------------------------------------------------------- -->


<table border="1" style="{!IF(propEligInt=1,'','display:none;')}{!IF(bedCheck=1,'','display:none;')}" class="hide">
    <tr>
        <td width="{!width1}">
            List Price
        </td>
        <td class="right" width="{!width2}">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!ListPrice}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Edison Twp Subsidy
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!Subsidy}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Reduced Sale Price
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!salePrice}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Your Down Payment
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!downpayment}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Twp. Down Payment Assistance
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!15000}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Mortgage Amount
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!Mortgage}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Estimated Monthly Costs
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, $###,###}">
                <apex:param value="{!estMonthlyCosts}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td>
            Percent of Monthly Income
        </td>
        <td class="right">
            <apex:outputText value="{0, Number, ###.##%}">
                <apex:param value="{!percentIncome}"/>
            </apex:outputText>
        </td>
    </tr>
    <tr>
        <td colspan="2" class="{!CASE(appEligInt,1,'elig',2,'inelig','')}">
            Applicant Eligibility Message
        </td>
    </tr>
    
    
</table>
</div>
</td>
</tr>
</table>



</apex:page>
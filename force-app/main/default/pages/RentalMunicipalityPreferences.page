<apex:page showheader="false" standardStylesheets="false" controller="CGPHProfileController" action="{!getRentalTownshipPreferences}" cache="false">
<c:CGPHComponent />

<style>
@import url(https://fonts.googleapis.com/css?family=Open+Sans:400,300,700,600);

@import url(https://fonts.googleapis.com/css?family=Oswald:400,700);


html {height:100%;}

*{
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
text-shadow:none;
text-rendering: optimizeLegibility;
}

.conatiner{
  layout:block;

}

body{
  font-family: 'Open Sans', sans-serif;
  /*font-size-adjust: .65;
  font-size: 175%;
  font-weight: 400;
  line-height:1.55;*/

  -webkit-animation-delay: 0.1s;
  -webkit-animation-name: fontfix;
  -webkit-animation-duration: 0.1s;
  -webkit-animation-iteration-count: 1;
  -webkit-animation-timing-function: linear;

}

@-webkit-keyframes fontfix {
    from { opacity: 1; }
    to   { opacity: 1; }
}


/* Header Test CSS */
h1 {
  font-family: 'Oswald', sans-serif;
  font-size: 3.5em;
  font-weight: 600;
  margin: 0;
}


h2 {
  font-family: 'Oswald', sans-serif;
  font-size: 3em;
  font-weight: 400;
  margin: 0 0 5px 0;
}


h3 {
  font-family: 'Open Sans', sans-serif;
  font-size: 2.25em;
  font-weight: 400;
  margin: 0;
}

h3 span {
  font-size: 2.5em;
  color: #777;
}

p,li{
  font-size:1.5em;
}

.normalText{
  font-size:1.5em;
}


/* Profile CSS */
.header {
  margin-bottom:10px;  
}



.SecondaryButton{
  font-size: 2.25em;
  font-family: 'Open Sans', serif;
  font-weight: 300;
  background-color: #007cc2;
  text-align: center;
  min-height: 50px;
  padding-top: 1px;
  color:white;
  cursor:pointer;
  border-radius: 2px;


  -webkit-box-shadow: 0 10px 6px -6px #777;
  -moz-box-shadow: 0 10px 6px -6px #777;
  box-shadow: 0 10px 6px -6px #777;
  -moz-user-select: none;
  /* Firefox */
  
  -ms-user-select: none;
  /* Internet Explorer */
  
  -khtml-user-select: none;
  /* KHTML browsers (e.g. Konqueror) */
  
  -webkit-user-select: none;
  /* Chrome, Safari, and Opera */
  
  -webkit-touch-callout: none;
  /* Disable Android and iOS callouts*/  
}

.SecondaryButton:hover {
  background-color: #229fe4;
}

.blueTitle1 {
  color: #007cc2;
}

.greenTitle1 {
  color: #1a876a;
}

.greyTitle1 {
  color: #aeaeae;
}

.blueBox2 {
  background-color: #007cc2;
}

.greenBox2 {
  background-color: #1a876a;
}

.greyBox2 {
  background-color: #aeaeae;
}


/*====================================================*/

.InfoContent {
  text-overflow: ellipsis;
  width: 100%;
  height: 220px;
  box-sizing: border-box;
  margin: 0px 10px 0px 10px;
  padding: 15px 10px 0px 20px;
  font-family: Open Sans;
  font-size: .8em;
  color: #fff;
  background-color: transparent;
  z-index: 100;
  position: relative;
  -moz-user-select: none;   /* Firefox */
  -ms-user-select: none;   /* Internet Explorer */
  -khtml-user-select: none;   /* KHTML browsers (e.g. Konqueror) */
  -webkit-user-select: none;  /* Chrome, Safari, and Opera */
  -webkit-touch-callout: none;  /* Disable Android and iOS callouts*/
}

.InfoArrow {
  width: 100%;
  height: 220px;
  position: absolute;
  top: 0px;
  padding: 0px 0px 0 0px;
  box-sizing: border-box;
  z-index: 50;
}

.InfoArrowTop {
  height: 110px;
  width: 90%;
  margin-left: 10px;
  -webkit-transform: skew(10deg, 0deg);
  -moz-transform: skew(10deg, 0deg);
  -ms-transform: skew(10deg, 0deg);
  -o-transform: skew(10deg, 0deg);
  transform: skew(10deg, 0deg);
}

.InfoArrowBottom {
  height: 110px;
  width: 90%;
  margin-left: 10px;
  -webkit-transform: skew(-6deg, 0deg);
  -moz-transform: skew(-6deg, 0deg);
  -ms-transform: skew(-6deg, 0deg);
  -o-transform: skew(-6deg, 0deg);
  transform: skew(-10deg, 0deg);
  -webkit-box-shadow: 0 10px 6px -6px #777;
  -moz-box-shadow: 0 10px 6px -6px #777;
  box-shadow: 0 10px 6px -6px #777;
}

.MunicipalityContainer {
  /*  cursor: pointer; */
  margin-bottom: 35px;
}

.MunicipalityContent {
  text-overflow: ellipsis;
  margin: 0px 10px 0px 10px;
  padding: 15px 10px 0px 20px;
  position:relative;
  font-family: Open Sans;
  font-size: .8em;
  height: 220px;
  color: #333;
  background-color: white;
  -webkit-box-shadow: 0 10px 6px -6px #777;
  -moz-box-shadow: 0 10px 6px -6px #777;
  box-shadow: 0 10px 6px -6px #777;
  -moz-user-select: none;  /* Firefox */
  -ms-user-select: none;  /* Internet Explorer */
  -khtml-user-select: none;  /* KHTML browsers (e.g. Konqueror) */
  -webkit-user-select: none;  /* Chrome, Safari, and Opera */
  -webkit-touch-callout: none;  /* Disable Android and iOS callouts*/
  border:1px solid #ddd;
}

.joinLeave{
  width:100%;
  height:219px;
  position:absolute;
  top:0px;
  left:0px;
  background-color: rgba(255, 255, 255, 0.8);
  text-align:center;
  padding-top:85px;
  font-size:2.5em;
  display:none;
}

.MunicipalityContent:hover .joinLeave{
    display: block;
}

.MunicipalityButton {
  font-size: 18px;
  bottom: 8px;
  right: 15px;
  position: absolute;
  font-family: 'Open Sans', serif;
  font-weight: 700;
}

.btn-info {
  border-radius: 0;
  float:right;
  font-family: 'Open Sans', sans-serif;
  font-size: 20px;
  font-weight: 500;
  background-color: #999999;
  border-color: #999999;
}

body.modal-open {
    overflow: hidden;
}

.modal-open {
    overflow: hidden;
}
    
.progress-bar.animate {
    width: 100%;
    overflow: hidden;
}

.MuniciplaityModalDialog{
    top:40%; 
    width:15%; 
    height:15%; 
    margin-top:0; 
    margin-right:auto; 
    margin-bottom:0; 
    margin-left:auto;
}
/* Loader Animation Styles */
.spinner {
    margin: 100px auto;
    width: 50px;
    height: 30px;
    text-align: center;
    font-size: 10px;
}

.spinner > div {
    background-color:white;
    height: 200%;
    width: 6px;
    display: inline-block;
    -webkit-animation: stretchdelay 1.2s infinite ease-in-out;
    -moz-animation: stretchdelay 1.2s infinite ease-in-out;
    animation: stretchdelay 1.2s infinite ease-in-out;
}

.spinner .rect2 {
    -webkit-animation-delay: -1.1s;
    -moz-animation-delay: -1.1s;
    animation-delay: -1.1s;
}

.spinner .rect3 {
    -webkit-animation-delay: -1.0s;
    -moz-animation-delay: -1.0s;
    animation-delay: -1.0s;
}

.spinner .rect4 {
    -webkit-animation-delay: -0.9s;
    -moz-animation-delay: -0.9s;
    animation-delay: -0.9s;
}

.spinner .rect5 {
    -webkit-animation-delay: -0.8s;
    -moz-animation-delay: -0.8s;
    animation-delay: -0.8s;
}

@-webkit-keyframes stretchdelay {
    0%, 40%, 100% { -webkit-transform: scaleY(0.4) }  
    20% { -webkit-transform: scaleY(1.0) }
}
@-moz-keyframes stretchdelay {
    0%, 40%, 100% { -moz-transform: scaleY(0.4) }  
    20% { -moz-transform: scaleY(1.0) }
}
@keyframes stretchdelay {
    0%, 40%, 100% { transform: scaleY(0.4); -webkit-transform: scaleY(0.4); -moz-transform: scaleY(0.4);} 
    20% { transform: scaleY(1.0); -webkit-transform: scaleY(1.0);  -moz-transform: scaleY(1.0);}
}


.messageText h4{
    display:none;
}
.message{
    margin-left: auto;
    margin-right: auto;
    width: 100%;
   /* margin-top: 6%;*/
    /*height: 13%;*/
    color:black;
    background-color: white;/*#A2ABEC;*/
    font-family: 'Open Sans', sans-serif;
    font-size: 30px;
    font-weight: 500;
    border: 10px;
    border-color: black;
    /*box-shadow: 7px 6px 15px -2px #777;*/
    /*color: #fff;*/
}
.backButton{
    float:right;
}
.errormessage{
    position:absolute;
}

  /*==========  Non-Mobile First Method  ==========*/
 
  /* Large Devices, Wide Screens */
  @media only screen and (max-width : 1200px){
 
  }
 
  /* Medium Devices, Desktops */
  @media only screen and (max-width : 992px){

  .MunicipalityContent  {
    height: 250px;
  }

  .InfoArrow {
    height: 250px;
  }

  .InfoArrowTop {
    height: 125px;
  }

  .InfoArrowBottom{
    height: 125px;
  }
  
  }
 
  /* Extra Small Devices, Phones */
  @media only screen and (max-width : 768px){



 }
  /* Extra Small Devices, Phones */

  @media only screen and (max-width : 480px){


  }

</style>
<script>
var actionElement = '';

$(document).ready(function(){
  // Setup background modal on start processing
  $('.js-loading-bar').modal({
    backdrop: 'static',
    show: false,
  });

  $('#helpLink').click(function() {
    startProcessing();
    actionElement = 'helpLink';
    // set the enpoint reference
    setEndpointURL('?json=get_page&id=4774');

  })
  
 

});

 
var que1;
var que2;

function setChildQuestionVisibility()
{
    debugger;
    que1 = $($('[id$=questionH1]')[0]).val();
    if( $('[id$=questionH1]')[0] ) // if question 1 is answered as yes
    {
        if( que1 == 'true')
        {
            // set visibility for second question section
            var a = $('[id$=childHquestion]')[0];
            a.style = 'display:block;';             
        }
        else
        {
            // set visibility for second question section
            var a = $('[id$=childHquestion]')[0];            
            a.style = 'display:none;';        
            $($('[id$=questionH1]')[0]).val('false');   
        }    
    }
}

function validateMontClair()
{
    var isValid = true;
    var montClairQ1 = true, montClairQ2 = true;
    if(  $($('[id$=question1]')[0]).val() == "" )
    {
        montClairQ1 = false;
        $('[id$=q1Err]')[0].style = 'display:block;color:red;';
    }
    else
    {
        $('[id$=q1Err]')[0].style = 'display:none;';
        montClairQ1 = true;
    }
    
    if(  $($('[id$=question2]')[0]).val() == "" )
    {
        montClairQ2 = false;
        $('[id$=q2Err]')[0].style = 'display:block;color:red;';
    }
    else
    {
        $('[id$=q2Err]')[0].style = 'display:none;';
        montClairQ2 = true;
    }    
    return (montClairQ1 && montClairQ2); 
}


function validateHoboken()
{
    debugger;
    var isValid = true;
    var hobokenQ1 = true, hobokenQ2 = true, hobokenQ3 = true;
    if(  $($('[id$=questionH1]')[0]).val() == "" )
    {
        $('[id$=qH1Err]')[0].style = 'display:block;color:red;';
        hobokenQ1 = false;
    }
    else
    {
        $('[id$=qH1Err]')[0].style = 'display:none;';
        hobokenQ1 = true;

        if( $($('[id$=questionH1]')[0]).val() == "true"  )
        {
            if(  $($('[id$=questionH2]')[0]).val() == "" )
            {
                hobokenQ2 = false;
                $('[id$=qH2Err]')[0].style = 'display:block;color:red;';
            }
            else
            {
                $('[id$=qH2Err]')[0].style = 'display:none;';
                hobokenQ2 = true;
            } 
         }   
    }
    
    if(  $($('[id$=questionH3]')[0]).val() == "" )
    {
        hobokenQ3 = false;
        $('[id$=qH3Err]')[0].style = 'display:block;color:red;';
    }
    else
    {
        $('[id$=qH3Err]')[0].style = 'display:none;';
        hobokenQ3 = true;
    }        
    
    if( $($('[id$=questionH1]')[0]).val() == "true" )
        return (hobokenQ1 && hobokenQ2 && hobokenQ3 );
        
    else if( $($('[id$=questionH1]')[0]).val() == "false"  )
         return ( hobokenQ1 && hobokenQ3 )
 
}




function saveLocalModalMontClairJS()
{
    debugger;
    startProcessing();
     que1 = $($('[id$=question1]')[0]).val();
     que2 = $($('[id$=question2]')[0]).val();
     hideLocalModal();
    // if( validateMontClair() )
         saveLocalModal();
   
}


function saveLocalModalHobokanJS()
{
    debugger;
    startProcessing();
     que1 = $($('[id$=question1]')[0]).val();
     que2 = $($('[id$=question2]')[0]).val();
     hideLocalModal();
    saveLocalModal();
    
}

function checkIfSuccess()
{
    debugger;
    if( que1 != '' )
    {
        /*if( que1 == 'true' || que2 == 'true' )
            stopProcessing('eligible');
        else
        {
            // create preference as Ineligible
            stopProcessing('ineligiblelocal');    
        } */
        
         stopProcessing('eligible');  
    }
    else
    {
          $('.js-loading-bar').find('.progress-bar').removeClass('animate');
          $('.js-loading-bar').modal('hide');
          $('.js-loading-bar').attr('style','display:none');
          $('#loading-curtain-div').attr('style','display:none');
          setTimeout(function() {
            $('#fade').attr('style','display:none');
            },100);
    }
}




function showModal(param){
  stopLoading();
  if( param == 'helpLink' ){
    $('#helpModal').on('shown.bs.modal',function() {
    })

    $('#helpModal').modal({show:true})
  }
}


// function for start loading process
function startProcessing() {
  $('.js-loading-bar').modal('show');
  $('.js-loading-bar').find('.progress-bar').addClass('animate');
}

  // function for stop loading process after complete
function stopProcessing(status) {
  $('.js-loading-bar').find('.progress-bar').removeClass('animate');
  $('.js-loading-bar').modal('hide');
  $('#loading-curtain-div').attr('style','display:none');
  setTimeout(function() {
    $('#fade').attr('style','display:none');
    },1000);
  //console.log('check status='+status)
  if(status == 'eligible')
    toastr.success('You have successfully joined the municipality waiting list');
  else
    toastr.info('You have successfully left the municipality waiting list');
}

function LeaveConfirmation(id,strMunicipalityName){
  $("#confirmationModal").modal('show');
  $(".MunicipalityValue").html('<p>By confirming, you will lose your place on the <span class="blueTitle1" style="font-weight:bold;">' + strMunicipalityName + '</span> rental waiting list and will no longer be contacted for available units.</p>');
  $("#btnRemove").off('click').click(function () {
    startProcessing();
    removeRentalWaitingList(id);
    $("#confirmationModal").modal("hide");
    $("#confirmationModal").modal("dismiss");
  });
}

function JoinConfirmation(id,strMunicipalityName,isLocal){
    debugger;
  if(isLocal == 'true'){
      startProcessing();
      showLocalModal(id, strMunicipalityName);
  }else{
  startProcessing();
  joinRentalWaitingList(id);
  } 
}

// Remove Loading Animation and dont show modal
function stopLoading() {
  $('.js-loading-bar').find('.progress-bar').removeClass('animate');
  $('.js-loading-bar').modal('hide');
  setTimeout(function() {
    $('#fade').attr('style','display:none');
  },1000);
}


</script>

 <apex:outputPanel rendered="{!b_ShowForm==false}" layout="block">
  <div class="modal-dialog modal-lg">
    <div class="modal-content" style="">
      <div class="modal-header">
        <div class="row" style="padding:0px 15px 0px 10px;">
          <div class="col-lg-12 col-md-11 col-sm-11 col-xs-11"><h2 style="padding-top:10px; padding-bottom:0px;">Affordable Homes New Jersey Profile Error</h2></div>         
        </div>
      </div>
      <div class="modal-body">
        <apex:pageMessages escape="false"></apex:pageMessages>
      </div>
    </div>
  </div>
  </apex:outputPanel>


<apex:outputPanel id="modalContent">
<!------------------------------------------------------------------------>
<!-- Modal Window Content                                               --> 
<!------------------------------------------------------------------------>

<!-- Welcome Help Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="helpModal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content" id="welcomeContent">
      <div class="modal-header">
        <div class="row" style="padding:0px 15px 0px 10px;">
          <div class="col-lg-11 col-md-11 col-sm-11 col-xs-11"><h2 style="padding-top:10px; padding-bottom:0px;">Welcome to Affordable Homes New Jersey Listings</h2></div>
          <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="font-size:2em;"><span aria-hidden="true">&times;</span></button>
          </div>
        </div>
      </div>
      <div class="modal-body">
        <apex:outputText value="{!HelpContent}" escape="false"></apex:outputText>
      </div>
    </div>
  </div>
</div>
</apex:outputPanel>



<div class="container ">
 
     
  <apex:form rendered="{!b_ShowForm}" id="prefForm">

  <apex:actionFunction name="setEndpointURL" action="{!setEndpoint}" reRender="modalContent" onComplete="showModal(actionElement);">
    <apex:param name="endPoint" value=""></apex:param> 
  </apex:actionFunction>

  <!------------------------------------------------------------------------>
  <!-- Header                                                             --> 
  <!------------------------------------------------------------------------>
  <div class="row header" style="margin-bottom:35px;">
    <div class="col-lg-10 col-sm-8 col-xs-8" style="padding-top:25px;">
      <h2 style="display:inline; color:#007cc2;  font-size:3.5em" id="AHNJ">Affordable Homes New Jersey</h2><span style="color:#007cc2; font-family: 'Open Sans', sans-serif; font-weight:300; font-size:2em;">  a CGP&amp;H service</span>
    </div>

    <div class="col-lg-2 col-sm-4 col-xs-4 SecondaryButton" style="margin-top:25px;" id="helpLink">Help</div>
  </div>

  <div class="row">

    <div class="col-lg-12 SecondaryButton" style="margin-top:0px; margin-bottom:30px;" onclick="ReturnToProfile()">Click Here When Done Joining/Leaving Waiting Lists</div>

    <h2 style="text-align:center; font-size: 4.25em;">Rental Waiting Lists</h2>
    <h3 style="margin-bottom:20px;text-align:center;">{!PreApplicantDetails.preApplicant.Applicant_Name__c}</h3>  
    <apex:actionFunction name="ReturnToProfile" action="{!returnToCGPHProfile}"/>

    <div class="col-lg-12">
      <ul style="font-size:1.2em; margin:20px 0;">
        <li>All the municipalities with rental properties administered by CGP&amp;H are listed below. If you are interested in a location that is not listed below, please contact the municipality directly.</li>
        <li>By joining the waiting list for a municipality, you will be considered for all of the rental developments within that municipality.</li> 
      </ul>
    </div>

  </div>


  <!-- Municipalities ------------------------------------------------------>
  <apex:outputPanel id="CGPHTownshipPreferences" styleClass="row" layout="block" style="padding:0 25px;" rendered="{!mapWrapperRentalMunicipalPreference != null}">    
    <!-- My Municipalities -->
    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 MunicipalityContainer">
      <div class="InfoContent">
        <h2 style="color:white;">My Waiting Lists</h2>
        <p>You are on the waiting lists for these municipalities. If you leave a waiting list, you will lose your position on that waiting list. Click &quot;Leave&quot; to be removed from a waiting list.</p>
      </div>

      <div class="InfoArrow">
        <div class="InfoArrowTop blueBox2"></div>
        <div class="InfoArrowBottom blueBox2"></div>
      </div>

    </div>

    <apex:repeat value="{!mapWrapperRentalMunicipalPreference['MyMunicipalities']}" var="MunicipalityReference"> 
    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 MunicipalityContainer" data-hover="false" data-status="{!MunicipalityReference.strStatus}" >
      <div class="MunicipalityContent" onClick="LeaveConfirmation('{!MunicipalityReference.municipalityId}','{!MunicipalityReference.strMunicipalityName}')">
          <apex:image style="float: right;" height="30" width="30" rendered="{!MunicipalityReference.b_isLocal == true}" value="{!$Resource.homeImage}"/> 
        <h2 class="{!MunicipalityReference.strStyle}">{!MunicipalityReference.strMunicipalityName}</h2>
        <apex:outputPanel rendered="{!MunicipalityReference.strStatus != 'inEligible'}">
          <p>{!MunicipalityReference.strCounty} County<br/>
          <apex:outputPanel rendered="{!MunicipalityReference.b_AppliedMuniciplaityPref}">
            Join Date:&nbsp;<apex:outputText value="{0,date,MM/dd/yyyy}"  ><apex:param value="{!MunicipalityReference.interestedDate}" /></apex:outputText><br/>
          </apex:outputPanel>
          {!MunicipalityReference.d_UnitSize} Units : {!MunicipalityReference.strUnitSize} Bedroom<br/>
          {!MunicipalityReference.strIncomeLevel} Income<br/>
         <!-- <apex:outputPanel rendered="{!MunicipalityReference.b_LiveWorkPreference}">Preference for Region {!MunicipalityReference.strRegion} Applicants</apex:outputPanel> -->
         </p>
  
        </apex:outputPanel>
        <div class="MunicipalityButton blueTitle1">               
<!--            <apex:commandLink value="+ Join" id="theCommandLink" styleClass="greenTitle1" action="{!joinRentalMunicipalityWaitingList}" onclick="startProcessing();" rendered="{!MunicipalityReference.strStatus=='eligible'}"  reRender="prefForm" oncomplete="stopProcessing('eligible')" >
              <apex:param name="strMunicipalityId" value="{!MunicipalityReference.municipalityId}" assignTo="{!strMunicipalityId}" />
            </apex:commandLink> 
    -->  
         <!-- <apex:outputpanel rendered="{!MunicipalityReference.strStatus=='WaitingList'}"> 
            <a href="" class="blueTitle1" style="cursor:pointer;" onClick="confirmation('{!MunicipalityReference.municipalityId}','{!MunicipalityReference.strMunicipalityName}')">-&nbsp;Leave</a>
          </apex:outputpanel> -->

          -&nbsp;Leave
        </div>
  
      <div class="joinLeave blueTitle1"><span class="glyphicon glyphicon-minus" aria-hidden="true" style="margin-right:8px;"></span>Leave</div>

      </div> <!-- End Municpality Content -->
      
      

    </div> <!-- End Municpality Container -->
    </apex:repeat>
           
  </apex:outputPanel> <!-- End row -->
  
  
  <apex:outputPanel id="CGPHTownshipPreferencesEligible" styleClass="row" layout="block" style="padding:0 25px;" rendered="{!mapWrapperRentalMunicipalPreference != null}">    
    <!-- Eligible Municipalities -->
    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 MunicipalityContainer">
      <div class="InfoContent">
        <h2 style="color:white;">Eligible Waiting Lists</h2>
        <p>Your profile indicates that you are eligible to join the waiting lists for these municipalities. Click &quot;Join&quot; to be added to a waiting list.</p>
      </div>

      <div class="InfoArrow">
        <div class="InfoArrowTop greenBox2"></div>
        <div class="InfoArrowBottom greenBox2"></div>
      </div>

    </div>
       
    <apex:repeat value="{!mapWrapperRentalMunicipalPreference['EligibleMunicipalities']}" var="MunicipalityReference"> 
    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 MunicipalityContainer" data-hover="false" data-status="{!MunicipalityReference.strStatus}" >
      <div class="MunicipalityContent" onClick="JoinConfirmation('{!MunicipalityReference.municipalityId}','{!MunicipalityReference.strMunicipalityName}','{!MunicipalityReference.b_isLocal == true}')">
         
      <!--  <apex:image style="float: right;" height="30" width="30" rendered="{!MunicipalityReference.b_isLocal == true}" value="{!$Resource.homeImage}"/> -->
        <h2 class="{!MunicipalityReference.strStyle}">{!MunicipalityReference.strMunicipalityName}</h2>
        <apex:outputPanel rendered="{!MunicipalityReference.strStatus != 'inEligible'}">
          <p>{!MunicipalityReference.strCounty} County<br/>
          <apex:outputPanel rendered="{!MunicipalityReference.b_AppliedMuniciplaityPref}">
            Join Date:&nbsp;<apex:outputText value="{0,date,MM/dd/yyyy}"  ><apex:param value="{!MunicipalityReference.interestedDate}" /></apex:outputText><br/>
          </apex:outputPanel>
          {!MunicipalityReference.d_UnitSize} Units : {!MunicipalityReference.strUnitSize} Bedroom<br/>
          {!MunicipalityReference.strIncomeLevel} Income<br/>
        <!--  <apex:outputPanel rendered="{!MunicipalityReference.b_LiveWorkPreference}">Preference for Region {!MunicipalityReference.strRegion} Applicants</apex:outputPanel> -->
        </p>
        </apex:outputPanel> 

        <div class="MunicipalityButton greenTitle1">+&nbsp;Join
<!--
           <apex:commandLink value="+ Join" id="theCommandLink" styleClass="greenTitle1" style="cursor:pointer;" action="{!joinRentalMunicipalityWaitingList}" onclick="startProcessing();" rendered="{!MunicipalityReference.strStatus=='eligible'}"  reRender="prefForm" oncomplete="stopProcessing('eligible')">
            <apex:param name="strMunicipalityId" value="{!MunicipalityReference.municipalityId}"  />
          </apex:commandLink> 
-->
        </div>

        <div class="joinLeave greenTitle1"><span class="glyphicon glyphicon-plus" aria-hidden="true" style="margin-right:8px;"></span>Join</div>

      </div> <!-- End Municpality Content -->
    </div> <!-- End Municpality Container -->
    </apex:repeat>
           
  </apex:outputPanel> <!-- End row -->
  
  
  
   <apex:outputPanel id="CGPHTownshipPreferencesInEligible" styleClass="row" layout="block" style="padding:0 25px;" rendered="{!mapWrapperRentalMunicipalPreference != null}">    
    <!-- Ineligible Municipalities -->
    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 MunicipalityContainer">
      <div class="InfoContent">
        <h2 style="color:white; letter-spacing:-0.5px;">Ineligible Waiting Lists</h2>
        <p>Your profile indicates that you are not eligible to join the waiting lists for these municipalities. The reasons you are ineligible are listed for each municipality.</p>
      </div>

      <div class="InfoArrow">
        <div class="InfoArrowTop greyBox2"></div>
        <div class="InfoArrowBottom greyBox2"></div>
      </div>
    </div> 
    <apex:repeat value="{!mapWrapperRentalMunicipalPreference['InEligibleMunicipalities']}" var="MunicipalityReference"> 
    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6 MunicipalityContainer" data-hover="false" data-status="{!MunicipalityReference.strStatus}" >
      <div class="MunicipalityContent">
        <h2 class="{!MunicipalityReference.strStyle}">{!MunicipalityReference.strMunicipalityName}</h2>
         <apex:outputPanel rendered="{!MunicipalityReference.strStatus == 'inEligible'}">
          <p>{!MunicipalityReference.strCounty} County<br/>
          <apex:repeat value="{!MunicipalityReference.lstStrMessage}" var="strMessage">
            <apex:outputText value="{!strMessage}" escape="false" />
          </apex:repeat></p>
         </apex:outputPanel>
      </div> <!-- End Municpality Content -->
    </div> <!-- End Municpality Container --> 
    </apex:repeat>
           
  </apex:outputPanel> <!-- End row -->
    
    <apex:outputPanel id="answerContainer">
<apex:outputPanel rendered="{!b_showLocalModal}" styleClass="modal fade bs-example-modal-lg in" style="display:block;background: #00000057;"  id="answerModal">
  <apex:actionRegion >
    <div class="modal-dialog modal-lg">
    <div class="modal-content" id="welcomeContent"> 
      <div class="modal-header">
        <div class="row" style="padding:0px 15px 0px 10px;">
          <div class="col-lg-11 col-md-11 col-sm-11 col-xs-11"><h2 style="padding-top:10px; padding-bottom:0px;">{!localAnswers.Municipality__r.Name}</h2></div>
          <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
            <button type="button" onclick="startProcessing();closeLocalModal();" class="close" data-dismiss="modal" aria-label="Close" style="font-size:2em;"><span aria-hidden="true">&times;</span></button>
          </div>
        </div>
      </div>
        
      
      <!-- start code for montaclair -->
      <apex:outputPanel rendered="{!strMunicipalityId == cgphProfileCustomSettings.Montaclair_Municipality_Id__c }">
      <div class="modal-body">
          <apex:pageMessages ></apex:pageMessages>
        <div class="form-group">
            <label>Does your household live in Montclair?</label>
            <apex:selectList size="1" styleClass="form-control" required="true" value="{!LiveInMontaclair}" id="question1">
                <apex:selectOption itemLabel="Yes" itemValue="true"></apex:selectOption>
                <apex:selectOption itemLabel="No" itemValue="false"></apex:selectOption>
                <apex:selectOption itemLabel="Please Select" itemValue=""></apex:selectOption>
            </apex:selectList>
            <span style="display:none;color:red;" id="q1Err">This field is required</span>
          </div>
          <div class="form-group">
              <label>Is a member of your household a full time employee of either the Township of Montclair or the Township of Montclair Board of Education?
                </label>
              <apex:selectList size="1" styleClass="form-control" required="true" value="{!FullTimeEmpMontClair}" id="question2">                
                <apex:selectOption itemLabel="Yes" itemValue="true"></apex:selectOption>
                <apex:selectOption itemLabel="No" itemValue="false"></apex:selectOption>
                <apex:selectOption itemLabel="Please Select" itemValue=""></apex:selectOption>
            </apex:selectList>
            <span style="display:none;color:red;" id="q2Err">This field is required</span>
          </div>
          <button type="button" class="btn btn-default" onclick="if(validateMontClair())saveLocalModalMontClairJS();return false;">Submit</button>
      </div>
      </apex:outputPanel>
      <!-- end code for montaclair -->
      
      <!-- start code for hoboken-->
     <apex:outputPanel rendered="{!(strMunicipalityId == cgphProfileCustomSettings.Hoboken_Municipality_Id__c || strMunicipalityId == cgphProfileCustomSettings.Hoboken_Workforce_Program_Id__c)}">
      <div class="modal-body">
          <apex:pageMessages ></apex:pageMessages>
        <div class="form-group">
            <label>Does your household live in Hoboken?</label>
            <apex:selectList size="1" styleClass="form-control" required="true" value="{!LiveInHoboken}" id="questionH1" onchange="setChildQuestionVisibility()">
                <apex:selectOption itemLabel="Yes" itemValue="true"></apex:selectOption>
                <apex:selectOption itemLabel="No" itemValue="false"></apex:selectOption>
                <apex:selectOption itemLabel="Please Select" itemValue=""></apex:selectOption>
            </apex:selectList>
            <span style="display:none;color:red;" id="qH1Err">This field is required</span>
          </div>
          <div class="form-group" style="display:none;" id="childHquestion">
              <label>Has a member of your household lived in Hoboken for at least one year?
                </label>
              <apex:selectList size="1" styleClass="form-control" required="false" value="{!LivedForYearInHoboken}" id="questionH2">                
                <apex:selectOption itemLabel="Yes" itemValue="true"></apex:selectOption>
                <apex:selectOption itemLabel="No" itemValue="false"></apex:selectOption>
                <apex:selectOption itemLabel="Please Select" itemValue=""></apex:selectOption>
            </apex:selectList>
            <span style="display:none;color:red;" id="qH2Err">This field is required</span>
          </div>
          <div class="form-group">
              <label>Is a member of your household an employee of the City of Hoboken, the Hoboken Board of Education, any Hoboken Charter School, or the Hoboken Housing Authority?
                </label>
              <apex:selectList size="1" styleClass="form-control" required="true" value="{!EmployeeInHoboken}" id="questionH3">                
                <apex:selectOption itemLabel="Yes" itemValue="true"></apex:selectOption>
                <apex:selectOption itemLabel="No" itemValue="false"></apex:selectOption>
                <apex:selectOption itemLabel="Please Select" itemValue=""></apex:selectOption>
            </apex:selectList>
            <span style="display:none;color:red;" id="qH3Err">This field is required</span>
          </div>
          <button type="button" class="btn btn-default" onclick="if(validateHoboken())saveLocalModalHobokanJS();else return false;">Submit</button>
      </div>
      </apex:outputPanel> 
      <!-- end code for hoboken-->

    </div>
  </div>
      <apex:actionFunction name="saveLocalModal" action="{!saveLocalModal}" reRender="prefForm" oncomplete="checkIfSuccess()"/>
    </apex:actionRegion>
</apex:outputPanel>
</apex:outputPanel>
    
  <div class="row">
    <div class="col-lg-12 SecondaryButton" style="margin-top:15px; margin-bottom:15px;" onclick="ReturnToProfile()">Click Here When Done Joining/Leaving Waiting Lists</div>
  </div>

<!------------------------------------------------------------------------>
<!-- Footer                                                             --> 
<!------------------------------------------------------------------------>
  <div class="row" style="margin:50px 0 25px;">
    <div class="col-xs-4">
      <img src="https://www.affordablehomesnewjersey.com/wp-content/uploads/2016/10/cgph-logo.png" style="width:100%;"/>
   </div>
    <div class="col-xs-6 normalText" style="text-align:center; margin-top:38px;">&copy; 2016 CGP&amp;H.  All rights reserved.  <a href="https://www.affordablehomesnewjersey.com/cgph-privacy-policy" target="_blank">Privacy Policy</a>
    </div>

    <div class="col-xs-2" style="text-align:right;">
      <img src="https://www.affordablehomesnewjersey.com/wp-content/uploads/2016/02/fheo75.png" style="margin-right:10px;"/>
    </div>
  </div>


  <apex:actionFunction name="removeRentalWaitingList" action="{!removeRentalMunicipalityWaitingList}" rerender="prefForm" onComplete="stopProcessing('WaitingList')">
    <apex:param name="strMunicipalityId" assignTo="{!strMunicipalityId}" value="" />
  </apex:actionFunction>

  <apex:actionFunction name="joinRentalWaitingList" action="{!joinRentalMunicipalityWaitingList}" rerender="prefForm" onComplete="stopProcessing('eligible')">
    <apex:param name="strMunicipalityId" assignTo="{!strMunicipalityId}" value="" />
  </apex:actionFunction>
    
    <apex:actionFunction name="showLocalModal" action="{!showLocalModal}" rerender="prefForm" onComplete="stopLoading();">
    <apex:param name="strMunicipalityId" value="" />
    <apex:param name="strMunicipalityName" value="" />
    </apex:actionFunction>  
    <apex:actionFunction immediate="true" name="hideLocalModal" action="{!hideLocalModal}" rerender="prefForm" onComplete="">
    </apex:actionFunction>  
    <apex:actionFunction immediate="true" name="closeLocalModal" action="{!closeLocalModal}" rerender="prefForm" onComplete="stopLoading();">
    </apex:actionFunction>

  </apex:form>
</div>

<!-- Loading image and overlay  -->
<div id="fade" class="processing_overlay"></div> 
<div class="modal js-loading-bar" style="width:100%;">
    <div class="modal-dialog MuniciplaityModalDialog" >
    <!-- Rectangles for loading animation  -->
        <center>
            <div class="spinner">
                <div class="rect1"></div>
                <div class="rect2"></div>
                <div class="rect3"></div>
                <div class="rect4"></div>
                <div class="rect5"></div>
            </div>
        </center>
    </div>
</div> 

<div id="confirmationModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Confirmation</h4>
            </div>
            <div class="modal-body MunicipalityValue">
                
                <!--  <p class="text-warning"><small>If you don't save, your changes will be lost.</small></p>-->
                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="btnRemove">Confirm</button>
            </div>
        </div>
    </div>
</div>
</apex:page>